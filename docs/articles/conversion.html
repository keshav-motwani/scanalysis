<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Conversion Vignette • scanalysis</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Conversion Vignette">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">scanalysis</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/conversion.html">Conversion Vignette</a>
    </li>
    <li>
      <a href="../articles/preprocessing.html">Preprocessing Vignette</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/keshavmot2/scanalysis">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Conversion Vignette</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/keshavmot2/scanalysis/blob/master/vignettes/conversion.Rmd"><code>vignettes/conversion.Rmd</code></a></small>
      <div class="hidden name"><code>conversion.Rmd</code></div>

    </div>

    
    
<p>For this tutorial, we demonstrate the conversion utilities in <code>scanalysis</code> to streamline the analysis process by using functions from Bioconductor and Seurat interchangably. In the current implementation of <code><a href="https://rdrr.io/pkg/Seurat/man/as.SingleCellExperiment.html">Seurat::as.SingleCellExperiment</a></code> and <code><a href="https://rdrr.io/pkg/Seurat/man/as.Seurat.html">Seurat::as.Seurat</a></code>, lots of information is lost, preventing downstream analysis and causing errors if the object was converted at some point. Some examples of this are shown below before we begin to use the functionality in this package.</p>
<p>In this example, we aim to integrate two Seurat objects with the overall analysis plan as below:</p>
<ol style="list-style-type: decimal">
<li>Normalize using SCTransform (includes identifying highly variable genes)</li>
<li>Run PCA on highly variable genes</li>
<li>Convert to <code>SingleCellExperiment</code> and back to <code>Seurat</code> objects (many possible reasons for this in practice, but we keep it general by just converting back and forth)</li>
<li>Integrate objects</li>
</ol>
<p>We will note some roadblocks using the <code>Seurat</code> conversion implementation and introduce our implementation. Note that our implementation utilizes the <code>Seurat</code> implementation but adds upon it.</p>
<p>First we load scanalysis and load our example <code>Seurat</code> object.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(scanalysis)</span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a>seurat_original =<span class="st"> </span>Seurat<span class="op">::</span>pbmc_small</span></code></pre></div>
<p>Next we normalize using <code>SCTransform</code> and run PCA on the highly variable genes.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>seurat_normalized =<span class="st"> </span>seurat_original <span class="op">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="st">  </span>Seurat<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/Seurat/man/SCTransform.html">SCTransform</a></span>(<span class="dt">verbose =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="st">  </span>Seurat<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/Seurat/man/RunPCA.html">RunPCA</a></span>(<span class="dt">verbose =</span> <span class="ot">FALSE</span>, <span class="dt">features =</span> Seurat<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/Seurat/man/VariableFeatures.html">VariableFeatures</a></span>(.))</span></code></pre></div>
<p>Next we convert to a <code>SingleCellExperiment</code> object, using the <code>Seurat</code> implementation.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>sce_converted =<span class="st"> </span>seurat_normalized <span class="op">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="st">  </span>Seurat<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/Seurat/man/as.SingleCellExperiment.html">as.SingleCellExperiment</a></span>()</span></code></pre></div>
<p>We convert this back into a <code>Seurat</code> object now, and note the information lost in the conversion process:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>seurat_converted =<span class="st"> </span>sce_converted <span class="op">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="st">  </span>Seurat<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/Seurat/man/as.Seurat.html">as.Seurat</a></span>()</span></code></pre></div>
<p>First we try to look for the highly variable genes in the converted object.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="st">"Variable Features pre-conversion:"</span>)</span></code></pre></div>
<p>Variable Features pre-conversion:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(Seurat<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/Seurat/man/VariableFeatures.html">VariableFeatures</a></span>(seurat_converted))</span></code></pre></div>
<p>logical(0)</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="st">"Variable Features post-conversion:"</span>)</span></code></pre></div>
<p>Variable Features post-conversion:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(Seurat<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/Seurat/man/VariableFeatures.html">VariableFeatures</a></span>(seurat_normalized))</span></code></pre></div>
<p>[1] “NKG7” “PPBP” “GNLY” “PF4” “GNG11” “GZMB”</p>
<p>In the converted object, the HVGs are lost - this makes sense as they were never stored in the SCE object either.</p>
<p>Let’s look at some assay specific information now also. When <code>SCTransform</code> is run, it creates a new assay named <code>SCT</code> (or alternate experiment in <code>SingleCellExperiment</code> terminology). The details shown below generalize to any other assays, such as hashtags (commonly named <code>HTO</code>) or antibodies in a CITE-seq experiment (commonly named <code>ADT</code>).</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="st">"Alternate Experiment (SingleCellExperiment) names:"</span>)</span></code></pre></div>
<p>Alternate Experiment (SingleCellExperiment) names:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>SingleCellExperiment<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/altExps.html">altExps</a></span>(sce_converted)</span></code></pre></div>
<p>List of length 0 names(0):</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="st">"Assay (Seurat) names post-conversion:"</span>)</span></code></pre></div>
<p>Assay (Seurat) names post-conversion:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>Seurat<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/Seurat/man/Assays.html">Assays</a></span>(seurat_converted)</span></code></pre></div>
<p>[1] “RNA”</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="st">"Assay (Seurat) names pre-conversion:"</span>)</span></code></pre></div>
<p>Assay (Seurat) names pre-conversion:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>Seurat<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/Seurat/man/Assays.html">Assays</a></span>(seurat_normalized)</span></code></pre></div>
<p>[1] “RNA” “SCT”</p>
<p>Here, we see that the <code>SCT</code> assay was not converted into an alternate experiment in the <code>SingleCellExperiment</code> object, and that the converted <code>Seurat</code> object subsequently lost that information. This means that downstream analysis on the normalized data would not be possible after converting to <code>SingleCellExperiment</code> and back. If there were other assays such as <code>ADT</code> or <code>HTO</code> in the <code>Seurat</code> object, this would be lost in the <code>SingleCellExperiment</code> and subsequently the <code>Seurat</code> object.</p>
<p>We illustrate an example where this is an issue in an integration workflow. For simplicity and to not go out of scope of this tutorial, we begin to integrate an object with itself, according to this <a href="https://satijalab.org/seurat/v3.0/integration.html">vignette</a> under the <code>SCTransform</code> tab. In practice, integrating an object with itself would not be actually done, but it still illustrates the need for comprehensive conversion between object types.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>integration_list =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(seurat_converted, seurat_converted)</span>
<span id="cb15-2"><a href="#cb15-2"></a></span>
<span id="cb15-3"><a href="#cb15-3"></a>features =<span class="st"> </span>Seurat<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/Seurat/man/SelectIntegrationFeatures.html">SelectIntegrationFeatures</a></span>(<span class="dt">object.list =</span> integration_list, <span class="dt">nfeatures =</span> <span class="dv">3000</span>)</span>
<span id="cb15-4"><a href="#cb15-4"></a></span>
<span id="cb15-5"><a href="#cb15-5"></a>integration_list =<span class="st"> </span>Seurat<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/Seurat/man/PrepSCTIntegration.html">PrepSCTIntegration</a></span>(integration_list, <span class="dt">anchor.features =</span> features)</span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="co">## Error: The following assays have not been processed with SCTransform:</span></span>
<span id="cb15-7"><a href="#cb15-7"></a><span class="co">##  object: 1 - assay: RNA</span></span>
<span id="cb15-8"><a href="#cb15-8"></a><span class="co">##  object: 2 - assay: RNA</span></span></code></pre></div>
<p>This fails, because the SCT assay information was not carried over. In fact, even if the assay was converted into an alternate experiment and back into an assay, it would still fail. It requires the information from each of the slots in an <code>Assay</code> object to be converted into a <code>SingleCellExperiment</code> and vice versa. In this particular case, the data from the <code>misc</code> slot of each assay must be transferred to the <code>metadata</code> of the <code>SingleCellExperiment</code>. For example, some information like <code>VariableFeatures</code> in the <code>Seurat</code> object, requires the addition of some new slots to the <code>SingleCellExperiment</code> object, which we detail below. For now, we illustrate how our implementation avoids all the above problems.</p>
<p>We start with the normalized object, and convert into SCE and immediately back into Seurat.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>sce_converted_new =<span class="st"> </span>seurat_normalized <span class="op">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="st">  </span><span class="kw"><a href="../reference/seurat_to_sce.html">seurat_to_sce</a></span>()</span>
<span id="cb16-3"><a href="#cb16-3"></a></span>
<span id="cb16-4"><a href="#cb16-4"></a>seurat_converted_new =<span class="st"> </span>sce_converted_new <span class="op">%&gt;%</span></span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="st">  </span><span class="kw"><a href="../reference/sce_to_seurat.html">sce_to_seurat</a></span>()</span></code></pre></div>
<p>Now we try to look for the highly variable genes in the converted object.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="st">"Variable Features post-conversion:"</span>)</span></code></pre></div>
<p>Variable Features post-conversion:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(Seurat<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/Seurat/man/VariableFeatures.html">VariableFeatures</a></span>(seurat_converted_new))</span></code></pre></div>
<p>[1] “NKG7” “PPBP” “GNLY” “PF4” “GNG11” “GZMB”</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="st">"Variable Features pre-conversion:"</span>)</span></code></pre></div>
<p>Variable Features pre-conversion:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(Seurat<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/Seurat/man/VariableFeatures.html">VariableFeatures</a></span>(seurat_normalized))</span></code></pre></div>
<p>[1] “NKG7” “PPBP” “GNLY” “PF4” “GNG11” “GZMB”</p>
<p>The highly variable genes were successfully retained during the conversion process.</p>
<p>Now assay information:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="st">"Alternate Experiment (SingleCellExperiment) names:"</span>)</span></code></pre></div>
<p>Alternate Experiment (SingleCellExperiment) names:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>SingleCellExperiment<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/altExps.html">altExps</a></span>(sce_converted_new)</span></code></pre></div>
<p>List of length 1 names(1): RNA</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="st">"Assay (Seurat) names post-conversion:"</span>)</span></code></pre></div>
<p>Assay (Seurat) names post-conversion:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>Seurat<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/Seurat/man/Assays.html">Assays</a></span>(seurat_converted_new)</span></code></pre></div>
<p>[1] “SCT” “RNA”</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="st">"Assay (Seurat) names pre-conversion:"</span>)</span></code></pre></div>
<p>Assay (Seurat) names pre-conversion:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>Seurat<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/Seurat/man/Assays.html">Assays</a></span>(seurat_normalized)</span></code></pre></div>
<p>[1] “RNA” “SCT”</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="st">"Default Assay post-conversion:"</span>)</span></code></pre></div>
<p>Default Assay post-conversion:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>Seurat<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/Seurat/man/DefaultAssay.html">DefaultAssay</a></span>(seurat_converted_new)</span></code></pre></div>
<p>[1] “SCT”</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="st">"Default Assay pre-conversion:"</span>)</span></code></pre></div>
<p>Default Assay pre-conversion:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>Seurat<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/Seurat/man/DefaultAssay.html">DefaultAssay</a></span>(seurat_normalized)</span></code></pre></div>
<p>[1] “SCT”</p>
<p>The assays once again were successfully retained during the conversion process.</p>
<p>And the integration doesn’t fail:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>integration_list =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(seurat_converted_new, seurat_converted_new)</span>
<span id="cb31-2"><a href="#cb31-2"></a></span>
<span id="cb31-3"><a href="#cb31-3"></a>features =<span class="st"> </span>Seurat<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/Seurat/man/SelectIntegrationFeatures.html">SelectIntegrationFeatures</a></span>(<span class="dt">object.list =</span> integration_list, <span class="dt">nfeatures =</span> <span class="dv">3000</span>)</span>
<span id="cb31-4"><a href="#cb31-4"></a></span>
<span id="cb31-5"><a href="#cb31-5"></a>integration_list =<span class="st"> </span>Seurat<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/Seurat/man/PrepSCTIntegration.html">PrepSCTIntegration</a></span>(integration_list, <span class="dt">anchor.features =</span> features)</span></code></pre></div>
<p>We don’t finish the integration, as this was just to illustrate an error caused by the <code>Seurat</code> conversion implementation.</p>
<p>Now we describe briefly the implementation of conversion and corresponding places for information in the <code>Seurat</code> and <code>SingleCellExperiment</code> objects. As both of these data types may evolve over time, these conversion implementations will also need to, and if there is any loss of data not covered by this implementation, we ask that you create an <a href="https://github.com/keshavmot2/scanalysis/issues">issue</a>.</p>
<p>Each <code>Assay</code> in the <code>Seurat</code> object is stored as an <code>altExp</code> in the <code>SingleCellExperiment</code> object. Of note, the <code>SingleCellExperiment</code> has the <code>altExps</code> stored as <code>SingleCellExperiment</code>s under one main <code>SingleCellExperiment</code>. However, the <code>Seurat</code> object treats all <code>Assay</code>s at the same level, but there is a <code>DefaultAssay</code> attribute. When objects are converted, the <code>Assay</code> to be treated as the main one can be specified in the <code>default_assay</code> argument to <code>seurat_to_sce</code>. Right now it is not supported to interactively swap the main experiment in the <code>SingleCellExperiment</code> as would be done using the <code>DefaultAssay</code> function in <code>Seurat</code>. However, all functions in this package take an <code>altExp</code> argument where it makes sense, and if <code>altExp = NULL</code>, it uses the main highest-level data.</p>
<p>Within each object, information from each <code>Assay</code> is added into each (<code>altExp</code>) <code>SingleCellExperiment</code>. Information from the <code>misc</code> slot in the <code>Seurat</code> objects is transferred to the <code>metadata</code> attribute of the <code>SingleCellExperiment</code>. There is no slot for the scaled data in a <code>SingleCellExperiment</code>, so this is added to the <code>metadata(sce)$scaled</code>. This is also the case for the variable features, so this is added to the `metadata(sce)$variable_features.</p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Keshav Motwani <keshav.motwani>.</keshav.motwani></p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
